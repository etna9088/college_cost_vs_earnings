---
title: "Final Project"
author: "Madina Kanafina"
date: "`r Sys.Date()`"
documentclass: article
geometry: margin=1in
fontsize: 11pt
output:
  pdf_document:
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    dev: pdf
    highlight: tango
  html_document:
    theme: default
    self_contained: true
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    smart: true
    dev: svg
---

```{r setup, include = FALSE}
# DO NOT ALTER THIS CHUNK
# Set knitr options
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  fig.width = 5,
  fig.asp = 0.618,
  out.width = "70%",
  dpi = 120,
  fig.align = "center",
  cache = FALSE
)
# Load required packages
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(infer))
suppressPackageStartupMessages(library(modelr))
suppressPackageStartupMessages(library(broom))
# Load dataset
college <- read_rds("college.rds") %>%
  type_convert(
    na=vctrs::vec_c("", "NA", "PrivacySuppressed")
  )
# Set seed
set.seed(98261936)
```

## Introduction

The U.S. Department of Education's College Scoreboard dataset contains a lot of information about colleges across the United States. For this final project, I will investigate the question:

> "Is there a relationship between how much it costs to attend the college and how much its graduates earn 10 years after enrolling?"

This question is relevant and interesting because many students and families want to know if paying more for college leads to better financial outcomes. To answer this question, I will use the variable 'COSTT4_A'(average cost of attendance) as the predictor and 'MD_EARN_WNE_P10'(median earning of graduates after 10 years) as the outcome. I will create a linear regression model to see if there is a significant relationship between these two continuous variables. The results of this analysis could help students decide if higher college costs are worth it.



## Preprocessing

```{r}
college_reduced <- college %>%
  select(COSTT4_A, MD_EARN_WNE_P10) %>%
rename(
  avg_cost = COSTT4_A,
  median_earn_10yr = MD_EARN_WNE_P10
)
```

I've selected only the columns 'COSTT4_A' and 'MD_EARN_WNE_P10' because they are directly relevant to my question, and I've renamed them to make them more human-readible and easier to interpret during the analysis.



## Visualization

##### Avg Cost Histogram

```{r, fig.width=9, fig.height=6}
ggplot() +
  geom_histogram(data = college_reduced, aes(x = avg_cost), binwidth = 3000) +
  labs(
    title = "Distribution of Avg. Cost of Attendance",
    x = "Average Cost (in US dollars)",
    y = "Count"
  )
```

i. This histogram shows how college attendance costs are distributed. It helps us understand the typical cost range and whether some colleges are much more expensive than others.

ii. Most colleges have an average cost between $10k and $30k, with a noticeable peak around $20k. As costs increase beyond $30k, the number of colleges decreases. Very few institutions have costs above $60k, and there are no extreme outliers.


##### Median Earnings after 10 yrs Histogram

```{r, fig.width=9, fig.height=6}
ggplot() +
  geom_histogram(data = college_reduced, aes(x = median_earn_10yr),
                 binwidth = 3000, bins = 50) +
  labs(
    title = "Distribution of Median Earnings after 10 yrs",
    x = "Median Earnings (in US dollars)",
    y = "Count"
  )
```

i. This histogram shows the distrubution of how much college graduates earn 10 years after entry. It helps us see typical earnings, the overall pattern, and if there are any outliers. 

ii. The histogram above is right-skewed with the most earnings concentrated around $40k. Most of the data is in range of $0 to $100k. There are few colleges showing higher earnings above $100k, and few outliers between $120k and $250k. 


##### Avg Cost vs. Median Earnings

```{r, fig.width=9, fig.height=6}
ggplot() +
  geom_point(data = college_reduced, aes(x = avg_cost, y = median_earn_10yr)) + 
  labs(
    title = "Relationship between Avg Cost and Median Earnings",
    x = "Average Cost (in US dollars)",
    y = "Median Earning after 10 yrs (in US dollars)"
  )
```

i. This scatterplot shows the covariation between two continuous variables: average cost of attendance and median earning after 10 years of entry. It helps us see if spending more on colleges leads to higher earnings.

ii. There is a week upward trend: colleges with higher costs tend to have slightly higher earnings. Most colleges have costs below around $50k and earnings below around $70k. A few colleges have very high costs (over $70k) or very high earnings (over $100k).


##### Covariation between Institution Types and Med Earnings

```{r}
college_cleaned <- college %>%
  select(COSTT4_A, MD_EARN_WNE_P10, CONTROL) %>%
  rename(
    avg_cost = COSTT4_A,
    median_earn_10yr = MD_EARN_WNE_P10
  ) %>%
  mutate(
    instit_type = recode(
      CONTROL,
      `1` = "Public",
      `2` = "Pr.Non-profit",
      `3` = "Pr.For-profit"
    )
  )
```

```{r, fig.width=11, fig.height=6}
ggplot() +
  geom_violin(data = college_cleaned, aes(x = instit_type, 
                                           y = median_earn_10yr,
                                           fill = instit_type)) +
  facet_wrap(~instit_type) + 
  labs(
    title = "Distribution of Median Earnings by Institution Type",
    x = "Institution Type",
    y = "Median Earnings (in US dollars)"
  )
```
i. This violin plot shows how median earnings of graduates after 10 years on entry vary by institution type: public, private non-profit, and private for-profit. It helps us compare the range and patterns of earnings for each type of institution.

ii. The violin plot by type
     a. Private For-Profit: earnings are concentrated in the lower range, with most graduates earning below $50k, the distribution is narrow and skewed, suggesting a limited range of earnings.
     b. Private Non-Profit: median earnings are more spread out compared to For-Profit institutions. There is a wider range of earnings, with most graduates earning between $50k and $100k. Some outliers exist above $125k, indicating cases of high earnings.
     c. Public: earnings show a broader range compared to Private For-Profit institutions but are generally lower than Private Non-Profit institutions. Most graduates earn below $60k, but a few outliers reach above $120k.



## Summary Statistics

```{r}
avg_cost_summary <- college_cleaned %>%
  reframe(
    count = n(),
    mean = mean(avg_cost, na.rm = TRUE),
    median = median(avg_cost, na.rm = TRUE),
    range = range(avg_cost, na.rm = TRUE),
    sd = sd(avg_cost, na.rm = TRUE),
    iqr = IQR(avg_cost, na.rm = TRUE)
  )
```

```{r}
median_earn_summary <- college_cleaned %>%
  reframe(
    count = n(),
    mean = mean(median_earn_10yr, na.rm = TRUE),
    median = median(median_earn_10yr, na.rm = TRUE),
    range = range(median_earn_10yr, na.rm = TRUE),
    sd = sd(median_earn_10yr, na.rm = TRUE),
    iqr = IQR(median_earn_10yr, na.rm = TRUE)
  )
```



## Data Analysis

```{r}
model <- lm(median_earn_10yr ~ avg_cost, data = college_cleaned)
```

```{r}
model_summary <- tidy(model)
model_performance <- glance(model)
```

i. The linear model shows a statistically significant relationship between average cost and median earnings. The slope indicates that for every $1 increase in average cost, median earning increase by around $4.59. However, the R^{2} value (34.4%) suggests that average cost alone doesn't fully explain variations in median earnings. The model's significance (very low p-value) confirms that relationship is unlikely due to a random chance.


##### Observed vs. Predicted Plot

```{r}
college_filtered <- college_cleaned %>%
  filter(!is.na(avg_cost), !is.na(median_earn_10yr))
```

```{r}
model <- lm(median_earn_10yr ~ avg_cost, data = college_filtered)
```

```{r}
college_filtered <- college_filtered %>%
  mutate(
    predicted = predict(model),
    residuals = resid(model)
  )
```

```{r, fig.width=9, fig.height=6}
ggplot() +
  geom_point(data = college_filtered, aes(x = predicted, y = median_earn_10yr),
             alpha = 0.5) +
  geom_abline(slope = 1, intercept = 0, color = "red") +
  labs(
    title = "Observed vs. Predicted Plot",
    x = "Predicted Median Earnings",
    y = "Observed Median Earnings"
  )
```


##### Residuals vs. Predicted Plot

```{r, fig.width=9, fig.height=6}
ggplot() +
  geom_point(data = college_filtered, aes(x = predicted, y = residuals),
             alpha = 0.5) +
  geom_hline(yintercept = 0, color = "red") +
  labs(
    title = "Residuals vs. Predicted Plot",
    x = "Predicted Median Earnings",
    y = "Residuals"
  )
```


##### Q-Q Plot

```{r, fig.width=9, fig.height=6}
qqnorm(college_filtered$residuals, main = "Q-Q Plot of Residuals")
qqline(college_filtered$residuals, col = "red")
```

i. Linearity: reasonably satisfied, the points roughly follow along the red diagonal line, with some scatter suggesting the model doesn't fully capture all variability.

ii. Homoscedasticity: the residuals are scattered around the horizontal red line at 0, but the spread of residuals increases slightly as predicted values increase, which suggests a mild violation of the homoscedasticity assumption.

iii. Normality of Residuals: Most points lie close to the red diagonal line, indicating the residuals are approximately normally distributed. However, the tails deviate significantly from the line, which means presence of outliers. 



## Conclusion

In this analysis, I explored whether the average cost of attending a college affects the median earnings of its graduates 10 years after enrollment. The results showed a positive relationship: as the cost of attendance increases, median earnings tend to rise. However, the R^{2} value of 0.34 suggests that the cost of attendance explains only part of the variation in earnings. The scatterplot and model showed a clear positive trend between cost and earnings, but the diagnostic plot highlighted some limitations.For example, the spread of residuals increased with higher predictions, suggesting potential issues with the model's assumptions. The Q-Q plot showed some outliers, which means that not all residuals follow a normal distribution. 

These findings are important for understanding trade-offs of higher education. They suggest that while higher costs may lead to better earnings, other factors also matters. This information could help students, families, and colleges make better decisions about the value of education. To conclude, while the average cost of attendance impacts graduate earnings, it's only part of the bigger picture. Other factors, such as program types, location, or student demographics, may provide more information into what drives earnings.




